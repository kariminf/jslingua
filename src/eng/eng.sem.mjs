import Sem from "../sem.mjs";
import {LayerNormalization, Perceptron, JslBERTBlock, JslBERT} from "../_jslml.mjs";

function __prepare_jslBERT_encoder(){
    
  //WEIGHTS
  const 
  tok_emb_w = [
    [-0.14835047721862793, 0.3450855314731598, 0.2889499068260193, -0.14721012115478516, 
      -0.08399425446987152, 1.134225845336914, 1.2737774848937988, -0.8669348955154419, 
      -1.248388648033142, -2.300537586212158, 1.071799874305725, 0.5409876704216003, 
      -0.5539595484733582, -0.3169098198413849, 1.1857942342758179, -0.2165171056985855, 
      -0.5161178708076477, 1.509312629699707, -0.5443181991577148, -1.338119626045227, 
      0.31197646260261536, 0.27006226778030396, -1.4416202306747437, -0.6025914549827576, 
      1.7266095876693726, -0.16278846561908722, -0.18899847567081451, 1.2720036506652832, 
      0.2117753028869629, 0.30916574597358704, -2.0725226402282715, 0.9424055814743042, 
      0.6304396390914917, -1.8637009859085083, -1.563990592956543, 1.3235784769058228, 
      0.5652621984481812, -1.6052931547164917, -0.4908791482448578, 0.27445560693740845, 
      -0.8412891030311584, 1.518465280532837, -0.6881235837936401, -0.27623599767684937, 
      1.0896590948104858, 0.703425943851471, 1.4971052408218384, 0.5164021253585815, 
      0.21342331171035767, -1.1384652853012085, -0.7751291990280151, 0.49747055768966675, 
      -0.6136637330055237, 0.013171672821044922, -0.2672087252140045, 1.5690137147903442, 
      1.1016738414764404, -1.282475471496582, 0.5012934803962708, 0.16277845203876495, 
      0.7120474576950073, 0.8788523077964783, -0.3571832776069641, -0.967806339263916, 
      -0.21071286499500275, 1.079178810119629, 0.0577150322496891, -1.1748203039169312, 
      0.25060001015663147, -0.5111948847770691, -0.38636207580566406, 0.5804873704910278, 
      2.3873887062072754, -1.0719795227050781, -2.5610554218292236, 0.1610448807477951, 
      -1.6219923496246338, 1.017720103263855, 0.08858566731214523, 0.6549159288406372, 
      -1.5992780923843384, 0.47415268421173096, -1.130585789680481, 0.22393859922885895, 
      -1.7646313905715942, -1.1796351671218872, 0.024652229622006416, -0.6941200494766235, 
      1.1235121488571167, -0.48380863666534424, -0.413381963968277, 1.1762676239013672, 
      1.493123173713684, 0.33528831601142883, -1.0528786182403564, -0.3390750586986542, 
      0.7285792827606201, 0.056134823709726334, -2.128803014755249, 0.14275962114334106], 
    [0.19646117091178894, -1.7146893739700317, -1.5093379020690918, 0.016413267701864243, 
      0.0007157933432608843, 2.1957573890686035, 1.394425392150879, -1.2869985103607178, 
      0.7930376529693604, 1.2583709955215454, 1.5399285554885864, 0.585407018661499, 
      -0.7997011542320251, 0.9946233630180359, -0.25997376441955566, 1.3743150234222412, 
      0.8469604849815369, 0.7607325315475464, 0.5803744792938232, 1.5011616945266724, 
      1.3598676919937134, 1.0865191221237183, 1.1375094652175903, 0.6664108037948608, 
      0.2309933453798294, 2.546224594116211, -0.20241683721542358, 1.908294439315796, 
      1.1516283750534058, 1.8909188508987427, -0.28465738892555237, 0.5107721090316772, 
      -0.37762048840522766, 0.5558785796165466, 1.3546452522277832, -0.6286462545394897, 
      1.324559211730957, 0.13337843120098114, -1.0234520435333252, -0.7428074479103088, 
      0.8482639789581299, -0.2582554221153259, -0.7608373165130615, 0.08410988748073578, 
      -0.19078665971755981, -0.36759528517723083, 0.4480973482131958, -1.2010432481765747, 
      -1.288441777229309, -0.7407289147377014, -1.6321388483047485, 1.1277503967285156, 
      -0.06189729645848274, -2.0200514793395996, -0.9645458459854126, -2.1199164390563965, 
      -1.11867094039917, -0.847771406173706, -2.74544620513916, -0.26408278942108154, 
      0.23939315974712372, 0.4270899295806885, -1.8915787935256958, 0.8675731420516968, 
      0.10252690315246582, 0.6463667750358582, -0.1553802639245987, 1.2935528755187988, 
      -0.06472335755825043, 0.09216298907995224, -0.4012710750102997, -0.5273073315620422, 
      0.001603391719982028, 0.535338282585144, 1.3311536312103271, -0.38668665289878845, 
      -0.8570483326911926, 0.14807015657424927, 0.09449613094329834, -1.1927226781845093, 
      0.016127590090036392, -0.05711442232131958, 0.06892243772745132, 0.9709412455558777, 
      -0.11203374713659286, -0.7732248306274414, 0.7261314988136292, -0.6447905898094177, 
      -0.4189152121543884, 0.6152459383010864, -0.9504803419113159, -0.3861190676689148, 
      0.61005699634552, 1.6906862258911133, -0.9530138969421387, 0.08980990201234818, 
      0.9579284191131592, -0.14281725883483887, 0.756767213344574, -0.0004888921976089478], 
    [0.060018301010131836, 1.3401554822921753, -0.46510395407676697, -0.5028817653656006, 
      0.20914369821548462, -2.0772836208343506, 1.0143800973892212, -0.5824138522148132, 
      -0.28372934460639954, 2.3372015953063965, -0.28758323192596436, 0.6186784505844116, 
      0.698062539100647, -0.8783689737319946, 0.2722608745098114, -3.6522321701049805, 
      0.768843412399292, -1.0802091360092163, -1.4717835187911987, -0.16271212697029114, 
      0.0806960016489029, -1.7160332202911377, 0.144829660654068, 1.224184513092041, 
      -0.3086814880371094, -1.3228086233139038, -1.6861841678619385, -0.8013718128204346, 
      0.31129640340805054, -0.5143848657608032, 0.24085308611392975, -0.320163756608963, 
      0.8704569339752197, -0.7932345271110535, -0.9999494552612305, 0.31238481402397156, 
      -1.3984285593032837, 1.1458717584609985, 0.07063905894756317, 0.25092536211013794, 
      0.22682498395442963, 1.2935667037963867, 0.18955424427986145, -1.204172968864441, 
      0.01681441441178322, 1.8607791662216187, -0.5631113648414612, -1.2550511360168457, 
      -0.2999681234359741, 0.38881802558898926, 0.32564038038253784, 1.0998140573501587, 
      -0.8079172372817993, -0.027507979422807693, 1.050919532775879, 0.6247667074203491, 
      0.14696219563484192, 1.5917704105377197, 0.32777440547943115, -0.6564246416091919, 
      -1.4580785036087036, -1.032153606414795, -0.9374450445175171, 0.7496157884597778, 
      0.0015850663185119629, 0.5010867118835449, -0.7304192185401917, 0.07459545135498047, 
      0.515209972858429, 0.937553346157074, -0.4660840630531311, -0.8450502157211304, 
      -1.1295973062515259, 0.9168542623519897, -0.15737856924533844, -1.049727201461792, 
      1.8308438062667847, 0.4081419110298157, -0.61019366979599, 0.2798902988433838, 
      0.6627289056777954, -0.9039402008056641, 1.3324942588806152, -0.9115517735481262, 
      -0.565049946308136, -1.5114119052886963, -0.6539024710655212, 0.5411242842674255, 
      -0.36274436116218567, 0.40945565700531006, -1.8299953937530518, -0.028939053416252136, 
      -1.2065922021865845, 0.32908257842063904, 0.2632899582386017, 0.09806737303733826, 
      -0.054531726986169815, 0.029474657028913498, 0.8950449228286743, 0.21430695056915283], 
    [-0.2332029491662979, 0.5308142304420471, -0.44028449058532715, -0.6896138787269592, 
      0.09225305914878845, 0.630730152130127, -0.1449631154537201, 1.276682734489441, 
      0.7838853001594543, 0.2684149146080017, 0.7301881909370422, -0.23667651414871216, 
      0.4117524027824402, 0.6438277959823608, -1.2224971055984497, 1.0071066617965698, 
      1.2238903045654297, -1.044900894165039, 1.6755821704864502, 0.7632668614387512, 
      1.4212409257888794, 1.1603288650512695, 0.5330750942230225, 0.6143758893013, 
      1.1883978843688965, 0.5791276097297668, 1.6493319272994995, 0.6796804070472717, 
      1.402881145477295, -0.5360223650932312, 1.552483320236206, 0.052664801478385925, 
      -0.6252380609512329, 0.445705384016037, -0.9977855682373047, 1.704397201538086, 
      -0.6918883323669434, 0.6809623837471008, -0.19748586416244507, -0.0800989419221878, 
      0.1789671778678894, 0.13166120648384094, 0.2734498381614685, -0.047148626297712326, 
      0.16163499653339386, 0.7787191867828369, -0.6536313891410828, 0.44687098264694214, 
      1.1656657457351685, 0.6819149255752563, 1.4335744380950928, 0.013481494970619678, 
      0.8348711729049683, -0.8817673921585083, 0.14107850193977356, 1.5011030435562134, 
      -0.38451477885246277, 0.5904780626296997, 0.9205483794212341, 0.06250012665987015, 
      -0.17212752997875214, -0.46624597907066345, 0.522211492061615, 1.1552613973617554, 
      -0.005970001220703125, 0.7973738312721252, -1.7038695812225342, -0.9580683708190918, 
      -0.987936794757843, -0.048687417060136795, -0.29293006658554077, -0.44865620136260986, 
      -0.3331605792045593, -0.028890924528241158, -1.182307481765747, -0.3822256028652191, 
      0.7160505056381226, 0.17765386402606964, -0.916806161403656, -0.619825541973114, 
      0.262361079454422, 0.09743008762598038, -1.0625087022781372, -0.050223514437675476, 
      -0.013087866827845573, 0.011649603955447674, 0.6983649730682373, -0.0552343912422657, 
      -1.1410077810287476, -0.2806723117828369, 0.651240348815918, -0.28140127658843994, 
      0.42912355065345764, -1.2102530002593994, -0.10372540354728699, -0.9681888222694397, 
      -1.2029454708099365, 0.5913116931915283, -0.8319231867790222, -0.19479109346866608], 
    [0.034465283155441284, 0.09516647458076477, -1.0118439197540283, 0.8025432229042053, 
      -0.007904386147856712, 0.587746262550354, 1.8189351558685303, -0.11013104766607285, 
      0.6568155288696289, -1.337499976158142, 0.5958341360092163, 0.39531445503234863, 
      1.0038703680038452, -0.2387143075466156, 1.1084460020065308, 1.1863399744033813, 
      1.176782488822937, 2.353032112121582, -2.5452513694763184, -0.7347394824028015, 
      -2.099363327026367, -0.27667951583862305, -2.3310136795043945, -1.3042237758636475, 
      0.0633235052227974, -1.053339958190918, -1.2097231149673462, -0.6599881052970886, 
      -0.12328920513391495, 0.8137549757957458, -0.7789437770843506, 0.6701577305793762, 
      -0.12845009565353394, 0.984408438205719, -0.34444770216941833, 0.02283870428800583, 
      -0.34794479608535767, 0.4357244074344635, 0.5478582382202148, -0.8099797368049622, 
      -0.9058820605278015, 1.0770477056503296, -1.2809027433395386, 0.1510293036699295, 
      0.6111496686935425, 0.3656895160675049, 0.5212313532829285, -0.009008340537548065, 
      -0.5673612356185913, -0.6749109625816345, -2.505743980407715, 0.1668626219034195, 
      -1.420304536819458, 0.9642336368560791, -0.6629571318626404, -1.2666356563568115, 
      -0.3558803200721741, -0.992289125919342, -0.3579999506473541, -0.726176917552948, 
      0.3547598719596863, -0.9212709665298462, -1.0955696105957031, 0.26297399401664734, 
      0.042411088943481445, 1.6438289880752563, -0.8844120502471924, -0.16881059110164642, 
      -0.31382617354393005, 0.565925121307373, 1.3263282775878906, 0.31041815876960754, 
      -0.06342912465333939, -0.311105340719223, -2.995560884475708, -0.2053242176771164, 
      -0.20409807562828064, 1.1449074745178223, 1.0218948125839233, 0.6978470683097839, 
      -1.5383220911026, 0.16950580477714539, 0.4975115954875946, 1.5066394805908203, 
      -1.5716243982315063, 1.7828441858291626, -0.09483656287193298, -0.9378759860992432, 
      -0.14406870305538177, 0.2917458415031433, 0.12560787796974182, -0.4483884871006012, 
      -1.4268275499343872, -1.3385019302368164, -0.35289523005485535, -0.09346403926610947, 
      0.18270528316497803, -0.040759287774562836, 0.45876312255859375, 0.05278980731964111], 
    [-0.11189760267734528, -1.2998753786087036, 1.3636163473129272, -0.7513375282287598, 
      0.07537674158811569, -1.9781196117401123, 0.21812471747398376, -0.25367841124534607, 
      0.7369168996810913, -1.8251535892486572, -0.3060385584831238, -0.8957073092460632, 
      0.03470219671726227, -0.22442291676998138, -1.2772380113601685, -0.1416330486536026, 
      -0.5827335119247437, 1.2894833087921143, -0.34234315156936646, 1.1872843503952026, 
      -2.4482316970825195, 0.6118112802505493, -0.7902172207832336, -1.1291875839233398, 
      -1.3915653228759766, 0.09818059206008911, -0.5867651700973511, -0.9003844857215881, 
      -0.4741005003452301, 1.7356672286987305, -0.8289406895637512, -1.4756704568862915, 
      -1.4307307004928589, 1.197912573814392, 1.7777718305587769, -2.7559993267059326, 
      1.3263171911239624, 1.4469026327133179, 1.4139289855957031, 1.3985528945922852, 
      2.0272510051727295, 0.9026679396629333, 0.7780497074127197, 2.2112505435943604, 
      0.8773046135902405, 0.09480027109384537, 0.4173777401447296, 1.4038194417953491, 
      1.2874726057052612, 1.9448390007019043, 0.3683774769306183, 1.1490973234176636, 
      1.4614399671554565, 1.9478837251663208, 1.4032361507415771, -0.8387762308120728, 
      -0.6154781579971313, -0.5916135311126709, -0.05541720986366272, -0.47127246856689453, 
      1.1989312171936035, 0.9180252552032471, -0.4676016867160797, -2.0409023761749268, 
      -0.1827530860900879, -0.336353063583374, 0.5361009240150452, -0.7172800898551941, 
      0.095736563205719, -0.11032333970069885, 0.8809637427330017, 0.0917835608124733, 
      -1.0775659084320068, 0.06888198107481003, 0.9576510190963745, -0.26159408688545227, 
      -1.118966817855835, -0.5201634764671326, 0.8379206657409668, -0.3305402100086212, 
      0.3491290807723999, -0.09507476538419724, 0.8567403554916382, 0.7609238028526306, 
      0.5277287364006042, 1.0952407121658325, 0.06897491216659546, -0.5552403330802917, 
      -0.5992768406867981, 0.6057610511779785, -0.2544773519039154, -1.3819295167922974, 
      -2.071439743041992, -0.2231716364622116, 0.026500903069972992, -0.014098331332206726, 
      -0.2871003746986389, 0.12064817547798157, -0.5525234937667847, -0.03169040381908417], 
    [0.12022349238395691, 0.9852505326271057, -0.18611553311347961, 0.2192048877477646, 
      -0.15109144151210785, 0.4782593846321106, 0.7136315703392029, 1.4785563945770264, 
      0.7909684181213379, 0.9853427410125732, -1.142629623413086, -0.24106454849243164, 
      0.8110588192939758, 0.9115395545959473, -0.19367074966430664, 0.9554018378257751, 
      0.4555329978466034, -0.8911306858062744, 0.33506613969802856, -0.027418794110417366, 
      -0.13663582503795624, -0.07390859723091125, 0.5706862211227417, 0.763498842716217, 
      -0.045488446950912476, -0.5647216439247131, 0.4874606132507324, -0.9548965096473694, 
      -0.10520430654287338, -0.6607881188392639, 1.6281977891921997, -0.5664166212081909, 
      -0.042672984302043915, 0.597087025642395, -1.2111485004425049, 1.2483705282211304, 
      -0.6658239960670471, 1.1908180713653564, 0.9572016000747681, 0.24888041615486145, 
      -0.7625722885131836, -0.03784980997443199, 0.7041866183280945, 0.03524648770689964, 
      -0.6182096004486084, 0.7367635369300842, -1.3192572593688965, 0.27935782074928284, 
      -0.21908622980117798, 0.569575846195221, 0.257841557264328, -0.2506556212902069, 
      -0.019311798736453056, 0.08249414712190628, 0.06467025727033615, 0.09188318252563477, 
      0.17994800209999084, 1.4079680442810059, 1.146671175956726, -0.1751914769411087, 
      -0.2593490183353424, -1.0677562952041626, 0.4793650507926941, 0.621385395526886, 
      0.17426303029060364, 1.3284169435501099, -0.5667309165000916, 0.20979942381381989, 
      -0.7939871549606323, 0.67213374376297, 0.190850168466568, -0.18378299474716187, 
      -1.5155271291732788, 0.539790153503418, -0.2973445653915405, -0.053604766726493835, 
      0.7890297174453735, -0.14788947999477386, -0.5506641268730164, 0.015502261929214, 
      -0.18725231289863586, -0.5331293344497681, -0.011071431450545788, -0.47613394260406494, 
      0.31801632046699524, 0.9023393988609314, -1.2302476167678833, 0.18870656192302704, 
      -0.1307709515094757, -0.1117502748966217, 0.4690157175064087, -0.5419642329216003, 
      -1.6571455001831055, -1.1130269765853882, 0.4751199781894684, 0.7000976204872131, 
      -1.7869160175323486, 0.07279645651578903, 1.2820338010787964, -0.020044609904289246], 
    [0.16740018129348755, -0.07756265997886658, -0.717696487903595, -0.21517421305179596, 
      -0.011088759638369083, 1.6484332084655762, 0.9190195798873901, 0.5505735278129578, 
      0.27641651034355164, 0.7433415651321411, -1.2404992580413818, -0.5645827054977417, 
      -0.6839333176612854, 0.9684019088745117, -0.6979751586914062, -0.0093701696023345, 
      -1.2566536664962769, -2.1088969707489014, 2.6573054790496826, 0.4543549120426178, 
      -0.04018311947584152, -0.8103950023651123, 1.0977449417114258, -0.5602752566337585, 
      -1.6862726211547852, -0.01517695002257824, 0.18037760257720947, -1.1416226625442505, 
      -1.8013441562652588, -2.1262173652648926, 0.46542081236839294, -0.6259586811065674, 
      -0.8916414976119995, -1.265185832977295, -1.0288041830062866, 1.1041748523712158, 
      0.7461037635803223, 0.20912468433380127, 0.03491763770580292, -0.47585994005203247, 
      -0.8723157644271851, -2.1362016201019287, 0.6552619934082031, 0.05164136365056038, 
      -1.8186174631118774, -0.8030876517295837, -1.3054510354995728, -0.06980250030755997, 
      -1.216231346130371, -0.2702528238296509, -0.12603573501110077, -0.9180741906166077, 
      0.5703902840614319, -1.6100800037384033, -1.6018197536468506, -0.6687556505203247, 
      -0.3392573297023773, 0.5235003232955933, -0.38287079334259033, 0.48834365606307983, 
      -0.18978288769721985, -0.4344054162502289, 0.5772203207015991, -0.6716766357421875, 
      0.14372733235359192, 1.2762541770935059, -0.03321976587176323, -0.997313916683197, 
      -0.6431032419204712, 0.18227386474609375, -0.5071106553077698, 0.1961870789527893, 
      -0.6762381196022034, 0.8412500023841858, 2.1939620971679688, 1.1570707559585571, 
      -0.27314624190330505, -0.761580765247345, -0.6121636629104614, -0.669611930847168, 
      0.4007797837257385, -0.11321944743394852, -1.1370782852172852, -0.37245646119117737, 
      1.7561705112457275, 0.603859007358551, -0.757948637008667, 0.37236249446868896, 
      0.38659781217575073, -0.08456502854824066, 1.1779987812042236, -0.3253135681152344, 
      -0.18272042274475098, 0.33750277757644653, 0.38138246536254883, 0.22948633134365082, 
      -0.6833719611167908, -0.143569216132164, 0.38229823112487793, 0.11170294880867004], 
    [0.03636351227760315, -0.9793848991394043, 0.8283202648162842, 0.3815915286540985, 
      -0.05197859928011894, 0.049271538853645325, -0.2344026416540146, -0.13900573551654816, 
      1.1566452980041504, 0.0017449876759201288, 1.2277016639709473, -1.102203607559204, 
      -0.21208561956882477, -1.003230094909668, -0.523043155670166, 0.462715208530426, 
      0.6131009459495544, 0.10563241690397263, 0.5848034024238586, 1.320778250694275, 
      0.9605916142463684, 1.265329360961914, -0.20540794730186462, -0.4172888696193695, 
      0.6998443603515625, 0.6724767684936523, 1.4765827655792236, 0.5449578762054443, 
      1.89469313621521, 0.24032363295555115, 1.0448083877563477, -0.41827476024627686, 
      -0.872692883014679, 1.638305425643921, 0.4243434965610504, 0.5469956994056702, 
      -0.21156883239746094, -0.49103137850761414, -0.8353933095932007, -0.9805362224578857, 
      1.3693667650222778, -1.0679689645767212, -0.3905350863933563, -0.1774526983499527, 
      1.0741416215896606, -1.2546955347061157, -0.468821257352829, 0.11903274059295654, 
      1.921817660331726, 0.785038411617279, 1.8473349809646606, -1.2655261754989624, 
      0.49667736887931824, 0.47756534814834595, 0.5059043765068054, 0.561793327331543, 
      -0.9348370432853699, -1.2741587162017822, -0.19744929671287537, -0.27873486280441284, 
      -0.7444133758544922, -0.050007984042167664, 0.521169126033783, 0.6668280363082886, 
      -0.07937446236610413, 1.4569146633148193, 0.4915519952774048, 0.8087720274925232, 
      0.5255003571510315, -1.188151478767395, -0.10769803822040558, -0.5024592280387878, 
      0.3430047035217285, -1.0941818952560425, -0.08518766611814499, -0.7366939187049866, 
      1.405393123626709, -0.6384975910186768, -0.7985668182373047, -0.8013290166854858, 
      0.9097710251808167, 0.5606718063354492, -0.006416619755327702, -0.06309065222740173, 
      0.14931608736515045, 0.4012654423713684, 2.065276861190796, -0.10779409855604172, 
      -1.3472280502319336, -0.3895981013774872, 0.9553540945053101, -0.5079713463783264, 
      1.089247465133667, -0.8992682695388794, 0.28425395488739014, -0.5791035294532776, 
      0.013812515884637833, -0.048162441700696945, -0.029781892895698547, -0.14528872072696686], 
    [-0.02572251856327057, 0.9700158834457397, 0.5114365816116333, -0.17592015862464905, 
      -0.1635826975107193, -1.3393590450286865, -0.08346274495124817, 0.2851170003414154, 
      -1.1605879068374634, -0.1020084097981453, -0.9436600208282471, 0.12233562767505646, 
      0.5103082656860352, 0.023807330057024956, 0.5002118945121765, -0.22626282274723053, 
      -0.20315736532211304, 0.5036255717277527, -0.5332253575325012, -0.498481422662735, 
      0.38180482387542725, 0.6075316071510315, 0.796976625919342, 2.212162971496582, 
      1.208054780960083, -0.12087986618280411, 0.028108572587370872, 0.32056233286857605, 
      0.9542258381843567, 1.7055528163909912, 0.36755573749542236, -0.9873998761177063, 
      1.0061759948730469, 0.16253088414669037, -0.22689953446388245, 0.13622432947158813, 
      0.405436635017395, 0.6733840703964233, 1.3652483224868774, 2.676255226135254, 
      0.9411895275115967, 2.3353466987609863, 1.6577625274658203, 0.7934421300888062, 
      1.1384303569793701, 1.748048186302185, 0.19705668091773987, 1.0619770288467407, 
      1.1884337663650513, 1.5303099155426025, 1.6320507526397705, 1.4469207525253296, 
      0.6881487369537354, 1.974427342414856, 2.6408445835113525, 1.5179468393325806, 
      1.7099450826644897, 1.4313781261444092, 2.089874744415283, -0.15943790972232819, 
      0.702041506767273, 1.0496426820755005, 0.27528226375579834, -1.4979803562164307, 
      -0.09019720554351807, -0.9090291261672974, 1.110103964805603, 1.3101876974105835, 
      -0.6332554221153259, 0.26501768827438354, -0.18132710456848145, 0.0044507598504424095, 
      -0.3536062240600586, 0.06857603788375854, 0.4181413948535919, -0.5922800302505493, 
      -0.26278382539749146, -0.1923333704471588, -0.16840483248233795, 0.6635742783546448, 
      -0.08364211767911911, -0.6734448671340942, 1.0821645259857178, -1.2461366653442383, 
      -0.30698296427726746, -1.1921896934509277, -1.5302541255950928, 0.2774083614349365, 
      1.0088692903518677, 0.00332522951066494, -1.3181840181350708, 0.31366315484046936, 
      -1.2538501024246216, 0.6007096767425537, 0.2011413425207138, 1.660275936126709, 
      -0.33143380284309387, -0.14293983578681946, 0.4163288176059723, 0.06520587205886841]
  ],
  tok_emb_b = [-0.02445279434323311, 0.01908877305686474, -0.10909192264080048, 
    0.0942913144826889, 0.050771258771419525, 0.093023881316185, 0.03279288113117218, 
    -0.05184762924909592, -0.15066993236541748, 0.002394468989223242],
  pos_emb_w = [
    [0.21456049382686615, -0.0009540769970044494, -0.30140960216522217, 0.05739083141088486, 
      0.24702857434749603, 0.35513216257095337, 0.4279584288597107, 0.45958390831947327, 
      0.4390312433242798, 0.45740777254104614, 0.45755237340927124, 0.43296200037002563, 
      0.4337707459926605, 0.45497584342956543, 0.421915203332901, 0.3624103367328644, 
      0.1326749622821808, 0.030136777088046074, 0.0821947455406189, 0.32433396577835083, 
      0.4297710061073303, 0.21300861239433289, 0.35378497838974, 0.27431851625442505, 
      0.39483869075775146, 0.2806621193885803, 0.0652770847082138, 0.15161621570587158, 
      -0.022078007459640503, -0.049272239208221436], 
    [-0.4269101619720459, -0.10181652754545212, -0.33051180839538574, -0.26884713768959045, 
      -0.09139969199895859, 0.08280495554208755, 0.29454898834228516, 0.41461363434791565, 
      0.42422857880592346, 0.4431076645851135, 0.39800235629081726, 0.3726060688495636, 
      0.35144874453544617, 0.3486135005950928, 0.3104403018951416, 0.18806758522987366, 
      0.003786590415984392, -0.18690705299377441, 0.02879210375249386, 0.3318330645561218, 
      0.2744045555591583, 0.35084429383277893, 0.13292063772678375, 0.12599343061447144, 
      0.2255782186985016, 0.18004101514816284, -0.16302043199539185, 0.20687443017959595, 
      0.21757125854492188, -0.10395565629005432], 
    [-0.5527791380882263, -0.640181303024292, -0.4093596041202545, -0.09624551981687546, 
      0.09512007236480713, 0.2555082142353058, 0.2820582389831543, 0.334259569644928, 
      0.34167343378067017, 0.3345019817352295, 0.3687085509300232, 0.35788294672966003, 
      0.3981306254863739, 0.33258193731307983, 0.3815026581287384, 0.2309151589870453, 
      -0.0033452187199145555, -0.10879696905612946, -0.11022261530160904, -0.058926213532686234, 
      0.12071080505847931, -0.18725143373012543, -0.13279488682746887, 0.0689648985862732, 
      -0.06080273538827896, -0.12274978309869766, -0.16611292958259583, 0.3716854453086853, 
      0.13527607917785645, -0.1271885633468628], 
    [-0.6042957305908203, 0.34199005365371704, -0.20462042093276978, -0.0029564888682216406, 
      0.02753056399524212, 0.012252789922058582, -0.017407141625881195, -0.01397531945258379, 
      -0.05858643725514412, -0.045725684612989426, -0.03165533393621445, -0.10354775190353394, 
      -0.017448753118515015, -0.05395124480128288, -0.05113658308982849, 0.08116364479064941, 
      -0.07345946133136749, -0.07699032127857208, -0.096310093998909, 0.1294664740562439, 
      0.20648910105228424, 0.012281930074095726, 0.048062779009342194, -0.05679656192660332, 
      0.0794631764292717, 0.20328405499458313, -0.13482581079006195, -0.13120999932289124, 
      0.21095454692840576, -0.2525900602340698], 
    [0.16008904576301575, -0.35068514943122864, -0.39192432165145874, -0.1991744041442871, 
      -0.028354447335004807, 0.1029856950044632, 0.2008575201034546, 0.2530646324157715, 
      0.23059381544589996, 0.22585955262184143, 0.1898958384990692, 0.18348024785518646, 
      0.18180547654628754, 0.1372433602809906, 0.13243208825588226, 0.002202558796852827, 
      -0.11646529287099838, -0.1600293070077896, -0.08657082915306091, 0.13337282836437225, 
      0.17596875131130219, 0.03263978287577629, 0.1251496970653534, 0.0005554762319661677, 
      -0.010398102924227715, 0.0478159636259079, -0.17645619809627533, -0.1939190775156021, 
      0.014436841011047363, -0.06902867555618286], 
    [-0.695417046546936, -0.3847774863243103, -0.539190948009491, -0.00497485650703311, 
      0.24235253036022186, 0.28692176938056946, 0.24529823660850525, 0.1930985003709793, 
      0.17501729726791382, 0.1675061136484146, 0.17059306800365448, 0.14309777319431305, 
      0.12531521916389465, 0.24606789648532867, 0.3080061078071594, 0.2623736560344696, 
      -0.020118435844779015, -0.05947938561439514, -0.11632047593593597, 0.025398125872015953, 
      0.41741523146629333, -0.14959731698036194, 0.21392443776130676, 0.4620533585548401, 
      0.30063191056251526, 0.10175354778766632, -0.18449510633945465, 0.05533728003501892, 
      0.09495842456817627, 0.20787614583969116], 
    [0.3692437708377838, 0.049340274184942245, -0.29589197039604187, -0.25709739327430725, 
      -0.18454962968826294, -0.08764637261629105, 0.07325751334428787, 0.18706588447093964, 
      0.19867350161075592, 0.21249589323997498, 0.18767639994621277, 0.17073795199394226, 
      0.22208236157894135, 0.11258944869041443, 0.1441984474658966, -0.009191700257360935, 
      -0.1313641220331192, -0.2062392234802246, -0.11528433114290237, 0.05769456923007965, 
      0.09062812477350235, 0.12926696240901947, -0.12776629626750946, -0.16317056119441986, 
      -0.02035597525537014, 0.14262734353542328, -0.18342627584934235, -0.14767490327358246, 
      -0.2823152244091034, 0.20468425750732422], 
    [0.2698137164115906, -0.14428551495075226, -0.2838953733444214, -0.08297121524810791, 
      0.015049557201564312, 0.11246783286333084, 0.2228444516658783, 0.3027990460395813, 
      0.3050718307495117, 0.31320127844810486, 0.25755032896995544, 0.27511125802993774, 
      0.27500370144844055, 0.2811102271080017, 0.25150981545448303, 0.19698761403560638, 
      -0.009825346060097218, -0.14492188394069672, 0.015166105702519417, 0.23455436527729034, 
      0.2511388957500458, 0.1752464324235916, 0.15802031755447388, 0.06605885922908783, 
      0.14820294082164764, 0.078335240483284, -0.27071914076805115, -0.3213356137275696, 
      -0.22001023590564728, -0.2482767254114151], 
    [1.031675934791565, -0.25936251878738403, 
      -0.3237345814704895, -0.2010284960269928, -0.06339779496192932, 0.07897717505693436, 
      0.21717345714569092, 0.2701354920864105, 0.2987458407878876, 0.2704935371875763, 
      0.27006950974464417, 0.259855180978775, 0.25286808609962463, 0.24653121829032898, 
      0.24796590209007263, 0.0653282180428505, -0.1497647911310196, -0.20940044522285461, 
      -0.12944522500038147, -0.015229487791657448, 0.09691338241100311, -0.05541606619954109, 
      -0.07178738713264465, -0.043202996253967285, -0.0390910767018795, -0.11624549329280853, 
      -0.2063034474849701, -0.15820525586605072, 0.1528247594833374, -0.04275938868522644], 
    [0.37188032269477844, 0.01600564830005169, -0.4022369086742401, -0.295189768075943, 
      -0.143692284822464, -0.04142080619931221, 0.12781725823879242, 0.19960901141166687, 
      0.20890192687511444, 0.21173718571662903, 0.21899409592151642, 0.1718771755695343, 
      0.17932775616645813, 0.16799035668373108, 0.2465467005968094, 0.14022453129291534, 
      -0.08181475102901459, -0.17732156813144684, -0.05132551118731499, 0.05246531218290329, 
      0.140997514128685, -0.12760858237743378, 0.053736332803964615, 0.003448988776654005, 
      0.09862595796585083, -0.0321219377219677, -0.2010784149169922, -0.09085273742675781, 
      0.1836147904396057, -0.1199963390827179]
  ],
  pos_emb_b = [-0.02445279434323311, 0.01908877305686474, -0.10909192264080048, 
    0.0942913144826889, 0.050771258771419525, 0.093023881316185, 0.03279288113117218, 
    -0.05184762924909592, -0.15066993236541748, 0.002394468989223242],
  seg_emb_w = [
    [0.06604959070682526, 0.33762675523757935], [-0.15106463432312012, -0.10763143002986908], 
    [0.4208979308605194, 0.4026414155960083], [-0.1499902755022049, -0.4416101276874542], 
    [0.18074771761894226, -0.41356828808784485], [-0.1543406993150711, -0.05807269364595413], 
    [-0.5373791456222534, 0.806541383266449], [0.44518786668777466, 0.1691180318593979], 
    [0.5216085314750671, 0.4488670825958252], [0.4581429958343506, -0.26327773928642273]
  ],
  seg_emb_b = [-0.02445279434323311, 0.01908877305686474, -0.10909192264080048, 
    0.0942913144826889, 0.050771258771419525, 0.093023881316185, 0.03279288113117218, 
    -0.05184762924909592, -0.15066993236541748, 0.002394468989223242],
  block0_h0_k_w = [
    [1.0131137371063232, 0.6920958757400513, 0.3999502956867218, -0.40490520000457764, 
      -0.16040310263633728, 0.6476355195045471, 1.1546767950057983, 0.26702117919921875, 
      0.9586551785469055, -0.13475550711154938], 
    [-0.4710460305213928, -0.1072334423661232, 0.17311693727970123, 0.8338310718536377, 
      0.877163290977478, 0.1441921442747116, -1.1955374479293823, 0.37104517221450806, 
      -0.01456748228520155, 0.13151045143604279], 
    [-0.7257612943649292, 0.7648258209228516, -0.8101163506507874, 0.4380229115486145, 
      0.12491852045059204, -0.9410598874092102, -0.2031157910823822, -0.39306601881980896, 
      0.04630374535918236, 0.9051958918571472], 
    [0.17213715612888336, 0.2286340594291687, 0.4500278830528259, 0.40575385093688965, 
      0.7585651278495789, -0.0525975301861763, -0.4297792911529541, 1.4464478492736816, 
      0.3856458365917206, 0.9138727188110352], 
    [-0.13018861413002014, -0.450014591217041, -0.01540947612375021, -0.5024622678756714, 
      0.4924236536026001, -0.39035922288894653, -1.4326534271240234, 0.9412757158279419, 
      0.3949441611766815, 0.949210524559021]
  ],
  block0_h1_k_w = [
    [0.14566335082054138, -0.24942225217819214, -0.043257370591163635, -0.478288859128952, 
      -0.5512832403182983, 0.49327123165130615, 0.748957633972168, -1.3292652368545532, 
      -0.07829409837722778, -0.6217700839042664], 
    [-0.31696391105651855, -0.0016261003911495209, -0.22009916603565216, -0.19552285969257355, 
      -1.189871072769165, -0.11707282811403275, 0.4550555646419525, -0.9084060192108154, 
      -0.6910998821258545, -0.9039294719696045], 
    [0.2644055485725403, -0.7081032991409302, -0.7739084959030151, -0.5170992612838745, 
      0.2517980635166168, 0.2174682766199112, -1.251076340675354, 0.3911474943161011, 
      -0.0013454249128699303, 0.5816239714622498], 
    [0.609306275844574, 0.227321594953537, -0.2752433121204376, -0.6137349605560303, 
      -0.3599185049533844, 0.08223890513181686, 1.1292951107025146, -0.44520846009254456, 
      0.19569748640060425, -0.3055579960346222], 
    [-1.1191322803497314, 0.12747354805469513, -0.3286806643009186, 0.5413830280303955, 
      0.5378100872039795, -0.8549861311912537, -0.9208492040634155, -0.41189906001091003, 
      -0.28867775201797485, 0.48697683215141296]
  ],
  block0_h0_k_b = [-0.21350209414958954, 0.35882073640823364, 
    0.21676744520664215, -0.1488247960805893, 0.11634035408496857],
  block0_h1_k_b = [0.18342949450016022, 0.1077498123049736, 
    -0.010637734085321426, 0.06682858616113663, 0.07680804282426834],
  block0_h0_q_w = [
    [1.1536877155303955, 1.4323025941848755, 0.6104398965835571, -0.926115095615387, 
      0.44687268137931824, -0.8483881950378418, 1.4982901811599731, 1.2051613330841064, 
      1.7291399240493774, 0.20649243891239166], 
    [-0.41848224401474, -0.7756657600402832, 1.0655957460403442, 0.0002480364637449384, 
      1.3311687707901, -0.5696493983268738, -1.6323052644729614, 1.159115195274353, 
      -0.2616443634033203, -0.36465907096862793], 
    [-1.461118459701538, 1.25836181640625, -1.5162843465805054, 1.0944159030914307, 
      0.4823288023471832, -1.7522333860397339, -0.1861146241426468, -0.9291861653327942, 
      -1.3752567768096924, 0.5169846415519714], 
    [0.2961980700492859, 0.2528029978275299, 0.6411189436912537, -0.20891769230365753, 
      1.1952511072158813, -0.9420572519302368, 0.0030884756706655025, 1.7429450750350952, 
      1.3475158214569092, 1.1053388118743896], 
    [0.6335909366607666, -0.24065904319286346, 0.13352255523204803, 1.3773518800735474, 
      0.7784895896911621, 0.184584841132164, -0.13844622671604156, 0.9442417025566101, 
      -0.26430147886276245, 0.9756524562835693]
  ],
  block0_h1_q_w = [
    [-0.08837922662496567, 1.473802089691162, -0.5784741640090942, 0.6052505373954773, 
      -0.4896251857280731, 0.37922513484954834, 1.01202392578125, -1.1923414468765259, 
      -1.3637293577194214, 0.3889079988002777], 
    [-0.7535462975502014, -0.2858714461326599, -1.014336109161377, 1.137205719947815, 
      -0.7909009456634521, 0.10266450047492981, 0.7372784614562988, -1.512863278388977, 
      -1.6605610847473145, -0.23151421546936035], 
    [-0.876659631729126, -0.3973125219345093, -0.5345475673675537, -1.468702793121338, 
      0.18203236162662506, -1.0410370826721191, -0.8371397852897644, 0.7471588850021362, 
      -0.09653449803590775, -0.2797246277332306], 
    [0.7444494366645813, 0.7935037612915039, 0.5431249737739563, -1.3149285316467285, 
      -0.5179746747016907, 0.5633427500724792, 0.8562547564506531, -0.021024703979492188, 
      -0.24632035195827484, -1.6929787397384644], 
    [-1.0251319408416748, -0.059711650013923645, -0.5247496962547302, 1.4823719263076782, 
      0.5760805606842041, -0.960517942905426, -0.3228347599506378, -0.5902739763259888, 
      -1.622867465019226, 1.3672453165054321]
  ],
  block0_h0_q_b = [0.09434603154659271, 0.5948050022125244, 
    -0.5033206343650818, 0.026202190667390823, 0.001871330663561821],
  block0_h1_q_b = [-0.32076165080070496, 0.18967176973819733, 
    0.3103865385055542, 0.16924446821212769, 0.7923919558525085],
  block0_h0_v_w = [
    [0.101883165538311, -0.25377199053764343, 0.2835496962070465, -0.5653868913650513, 
      -0.1560346484184265, 0.32295116782188416, -0.17325571179389954, -0.02864661253988743, 
      0.2704073488712311, 0.006725169252604246], 
    [0.14611506462097168, 0.3871229290962219, 0.4236467182636261, 0.45832696557044983, 
      -0.01719873771071434, 0.1320895552635193, 0.10406455397605896, -0.20364221930503845, 
      -0.6738964915275574, -0.04678197205066681], 
    [-0.07373243570327759, 0.004278983920812607, 0.3245585858821869, -0.4698563516139984, 
      0.4182691276073456, -0.5732543468475342, -0.003512193216010928, 0.4498216509819031, 
      0.08331332355737686, -0.17921577394008636], 
    [0.06717462837696075, -0.16045254468917847, -0.07717036455869675, 0.283488929271698, 
      0.00743143679574132, -0.05986205115914345, -0.020876871421933174, 
      -0.00010698044206947088, 0.41358092427253723, 0.6072031259536743], 
    [-0.3917752802371979, 0.12082558870315552, -0.2111818790435791, -0.029973892495036125, 
      -0.026295728981494904, -0.10629288852214813, -0.08670707792043686, 
      -0.5260112881660461, 0.02500699833035469, 0.24666248261928558]
  ],
  block0_h1_v_w = [
    [-0.06393737345933914, 0.6394391655921936, -0.20451074838638306, 0.3011646866798401, 
      0.00916131678968668, -0.030876399949193, 0.10742078721523285, -0.030302327126264572, 
      -0.042567528784275055, 0.1908152848482132], 
    [-0.2628060281276703, 0.33428317308425903, -0.35102415084838867, -0.48056286573410034, 
      0.1563563495874405, -0.4552946388721466, 0.2807888686656952, -0.3267224431037903, 
      0.21037809550762177, 0.39827072620391846], 
    [-0.05309518799185753, 0.22383347153663635, -0.41174858808517456, 0.47062352299690247, 
      0.006771985441446304, -0.24439914524555206, 0.419032484292984, -0.06848463416099548, 
      -0.11147281527519226, 0.5190573334693909], 
    [0.01866155117750168, 0.2509385347366333, -0.22199279069900513, 0.07580731064081192, 
      0.31801870465278625, -0.21975068747997284, 0.1238403394818306, 0.5323368906974792, 
      0.24761390686035156, -0.016124024987220764], 
    [0.09705967456102371, -0.0765160620212555, 0.2675989866256714, 0.11081623286008835, 
      -0.020243480801582336, -0.15433867275714874, 0.13571162521839142, 0.19449582695960999, 
      0.530714750289917, 0.4037207365036011]
  ],
  block0_h0_v_b = [-0.0685468390583992, 0.01156098023056984, 
    -0.14738522469997406, 0.1113203912973404, 0.041080012917518616],
  block0_h1_v_b = [0.13305264711380005, -0.21233518421649933, 
    0.020862944424152374, -0.04708933085203171, -0.018068356439471245],
  block0_hp_w = [
    [0.1466621607542038, 0.1622769981622696, -0.07769308984279633, -0.367719829082489, 
      0.28842440247535706, -0.231198251247406, -0.657316267490387, -0.10069283097982407, 
      -0.046275701373815536, 0.5077065825462341], 
    [-0.1237841546535492, -0.596777617931366, -0.3027797341346741, 0.12531472742557526, 
      0.3600021302700043, 0.335287868976593, 0.46921515464782715, 0.6694884300231934, 
      -0.11284970492124557, 0.34563952684402466], 
    [0.112721286714077, -0.29568663239479065, 0.5517235994338989, 0.09715870767831802, 
      -0.2774029076099396, -0.23353299498558044, -0.21848221123218536, -0.13048435747623444, 
      -0.30905452370643616, -0.10514787584543228], 
    [0.44408103823661804, 0.1748971939086914, -0.674744188785553, 0.16385693848133087, 
      -0.3979162573814392, 0.21068033576011658, -0.42751866579055786, 0.293350487947464, 
      -0.019642088562250137, 0.5414977669715881], 
    [0.15306828916072845, -0.3839590847492218, 0.04022599011659622, 0.26973727345466614, 
      -0.038815245032310486, 0.1914244145154953, -0.10822742432355881, 0.05777767673134804, 
      -0.3490535020828247, 0.13503779470920563], 
    [-0.33007070422172546, 0.06234318017959595, -0.20844872295856476, -0.1702587902545929, 
      -0.26768848299980164, -0.014400757849216461, -0.510787844657898, -0.7182183861732483, 
      -0.510581910610199, 0.4249480366706848], 
    [-0.05390466749668121, -0.27135634422302246, -0.2194252610206604, 0.7008655667304993, 
      0.24328552186489105, 0.2971728444099426, 0.3789823353290558, 0.37059059739112854, 
      0.06960452347993851, 0.26545289158821106], 
    [0.07772451639175415, 0.13622669875621796, 0.30412209033966064, 0.1721162647008896, 
      0.4840605556964874, -0.037166450172662735, -0.12280397862195969, -0.1530992090702057, 
      0.4130025804042816, 0.2831673324108124], 
    [-0.15012839436531067, 0.11565955728292465, 0.3146210014820099, -0.40680354833602905, 
      -0.40050190687179565, -0.05787990987300873, 0.0699736550450325, -0.23591268062591553, 
      -0.13773302733898163, 0.18997421860694885], 
    [-0.3531096577644348, 0.005712574813514948, -0.24442297220230103, 0.17230476438999176, 
      0.050187792629003525, -0.0467928983271122, 0.2290208786725998, 0.005459479987621307, 
      0.018401306122541428, 0.3614538311958313]
  ],
  block0_hp_b = [0.02184750884771347, 0.04217621311545372, -0.06309454143047333, 
    0.10885997116565704, 0.055282656103372574, 0.03530918434262276, -0.12742923200130463, 
    -0.15006358921527863, -0.05545850098133087, 0.10380949079990387],
  block0_ffp_w = [
    [0.10172263532876968, 0.4654006361961365, 0.31768110394477844, -0.13671277463436127, 
      -0.09100154787302017, 0.039152443408966064, 0.02598871849477291, 0.35917213559150696, 
      0.3510868549346924, 0.32058951258659363], 
    [0.5352637767791748, 0.5048266649246216, -0.02575583942234516, 0.5691477656364441, 
      -0.4043933153152466, 0.24173979461193085, -0.3333360254764557, -0.09633396565914154, 
      -0.6893108487129211, -0.2801056206226349], 
    [0.16411885619163513, -0.681833028793335, 0.2850569486618042, 0.9154834151268005, 
      -0.32783105969429016, -0.11040210723876953, -0.06395356357097626, -0.9242386817932129, 
      -0.4806261956691742, 0.4650972783565521], 
    [0.5616174340248108, -0.7101423144340515, 0.21987873315811157, 0.09794806689023972, 
      0.5192927718162537, -0.52816241979599, 0.10997225344181061, 0.152072474360466, 
      0.29016658663749695, -0.09255650639533997], 
    [-0.2549985945224762, 0.29356780648231506, 0.16965186595916748, -0.11335866898298264, 
      0.5156151056289673, -0.28798502683639526, 0.33886227011680603, 0.02500825561583042, 
      -0.4700751006603241, -0.5697600245475769], 
    [0.3442285656929016, -0.286151647567749, -0.5684532523155212, 0.2782054543495178, 
      0.516862690448761, 0.14855971932411194, 0.2480792999267578, -0.008618121035397053, 
      0.41835638880729675, 0.5261960029602051], 
    [-0.2120777815580368, 0.1603594273328781, 0.8815247416496277, -0.47506582736968994, 
      0.02636592835187912, 0.8996062278747559, -1.025694727897644, -0.2245488166809082, 
      0.8702782988548279, -0.14352372288703918], 
    [-0.2960570454597473, -0.16714896261692047, 0.1500224769115448, 0.21694323420524597, 
      -0.23307381570339203, 0.16157878935337067, 0.4392348527908325, 0.5135896801948547, 
      -0.2856222987174988, 0.14231514930725098], 
    [-0.4607236087322235, 0.19745893776416779, -0.34902408719062805, 0.3074711561203003, 
      -0.6911200284957886, -0.4634234607219696, -0.24232637882232666, -0.151215597987175, 
      -0.262764036655426, -0.4565296471118927], 
    [-0.9810225963592529, 1.2187222242355347, -1.190039038658142, -1.4868355989456177, 
      -0.20247416198253632, -1.1223224401474, 0.9537313580513, 0.13805654644966125, 
      0.6363016963005066, 1.2129747867584229]
  ],
  block0_ffp_b = [0.1056801974773407, -0.2868887484073639, 0.07412335276603699, 
    -0.3563942015171051, 0.07425787299871445, 0.13371367752552032, 0.2765193581581116, 
    -0.09877105057239532, -0.08045735210180283, -0.794448733329773],

  ln1_beta = [-0.03828439861536026, 0.048327021300792694, 0.012270016595721245, 
    -0.1249372735619545, 0.1352229118347168, 0.19751501083374023, -0.07491485029459, 
    0.08446764945983887, 0.23412734270095825, 0.0070854970254004],
  ln1_gamma = [1.1767117977142334, 0.9311692118644714, 1.2706806659698486, 
    2.304980993270874, 0.9899853467941284, 0.8470801711082458, 1.4346359968185425, 
    1.179012417793274, 1.3738926649093628, 1.1059640645980835],
  ln2_beta = [0.45437026023864746, -0.5718791484832764, -0.8784531950950623, 
    0.12035933881998062, 0.2130833864212036, -0.4408029317855835, 0.7435136437416077, 
    0.07995928078889847, -0.28457438945770264, 0.4162468910217285],
  ln2_gamma = [5.642808437347412, 3.0960893630981445, 2.994161605834961, 
    3.5820560455322266, 4.350632667541504, 4.670008659362793, 3.103781223297119, 
    4.467914581298828, 4.877044677734375, 1.5013707876205444];
      
  //PERCETRONS
  const tok_emb_p = new Perceptron(tok_emb_w, tok_emb_b),
        pos_emb_p = new Perceptron(pos_emb_w, pos_emb_b),
        seg_emb_p = new Perceptron(seg_emb_w, seg_emb_b),
        block0_h0_k_p = new Perceptron(block0_h0_k_w, block0_h0_k_b),
        block0_h1_k_p = new Perceptron(block0_h1_k_w, block0_h1_k_b),
        block0_h0_q_p = new Perceptron(block0_h0_q_w, block0_h0_q_b),
        block0_h1_q_p = new Perceptron(block0_h1_q_w, block0_h1_q_b),
        block0_h0_v_p = new Perceptron(block0_h0_v_w, block0_h0_v_b),
        block0_h1_v_p = new Perceptron(block0_h1_v_w, block0_h1_v_b),
        block0_hp_p = new Perceptron(block0_hp_w, block0_hp_b),
        block0_ffp_p = new Perceptron(block0_ffp_w, block0_ffp_b);
  
  //Layer normalisation
  const ln1 = new LayerNormalization(ln1_beta, ln1_gamma),
        ln2 = new LayerNormalization(ln2_beta, ln2_gamma);

  //Blocks
  const heads = [[block0_h0_q_p, block0_h0_k_p, block0_h0_v_p], 
                 [block0_h1_q_p, block0_h1_k_p, block0_h1_v_p]],
        block0 = new JslBERTBlock(heads, block0_hp_p, block0_ffp_p, ln1, ln2);
  
  //JslBERT
  return new JslBERT([tok_emb_p, pos_emb_p, seg_emb_p], [block0], true); 
  
}

class EngSem extends Sem {

  static max_length = 30;
  static nbr_chars = 100;

  static bertCharEmbedder = __prepare_jslBERT_encoder();
  
  static __word2BERTCodes(word){
    const tok = [[this.oneHot(2, this.nbr_chars), 
                  this.oneHot(0, this.max_length), 
                  [1, 0]]];//tok=CLS, pos=0, seg=0
    if (word.length + 2 > this.max_length) word = word.substring(0, this.max_length - 2)
    let i = 0;
    for (; i < word.length; i++){
      let char_code = word.charCodeAt(i);
      if ((char_code >= 33) && (char_code <= 126)){
        char_code = char_code - 28;
      }else{char_code = 1;}//unknown character

      // console.log(char_code);
      tok.push([this.oneHot(char_code, this.nbr_chars), 
        this.oneHot(i+1, this.max_length), [1, 0]]);//tok=char_code, pos=i+1, seg=0
    }
    
    tok.push([this.oneHot(3, this.nbr_chars), 
      this.oneHot(i+1, this.max_length), [1, 0]]);//tok=SEP, pos=i+1, seg=0
    i++;

    for (; i < this.max_length; i++){
        // console.log(char_code);
        tok.push([this.oneHot(0, this.nbr_chars), 
          this.oneHot(0, this.max_length), [1, 0]]);//tok=PAD, pos=0, seg=0
    }

    return tok;
  }

  static _word_emb_char(word){
    return this.bertCharEmbedder.predict(this.__word2BERTCodes(word))[0];
  }

}

export default EngSem;